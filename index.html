<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Engineering Student Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .header p {
            color: #666;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-icon {
            font-size: 28px;
            margin-right: 12px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .input-group input:focus, .input-group select:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background 0.3s;
        }

        button:hover {
            background: #5568d3;
        }

        button.delete-btn {
            background: #e74c3c;
            padding: 5px 10px;
            font-size: 12px;
        }

        button.delete-btn:hover {
            background: #c0392b;
        }

        .gpa-display {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            color: white;
            margin-top: 20px;
        }

        .gpa-number {
            font-size: 48px;
            font-weight: bold;
            margin: 10px 0;
        }

        .course-item, .assignment-item, .schedule-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timer-display {
            text-align: center;
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .quick-links {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .quick-link {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: background 0.3s;
        }

        .quick-link:hover {
            background: #e9ecef;
        }

        .formula-card {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .formula-card strong {
            color: #667eea;
        }

        .notes-area {
            width: 100%;
            min-height: 150px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            resize: vertical;
            font-family: inherit;
        }

        .priority-high {
            border-left: 4px solid #e74c3c;
        }

        .priority-medium {
            border-left: 4px solid #f39c12;
        }

        .priority-low {
            border-left: 4px solid #27ae60;
        }

        .completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        .category-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .tab-btn {
            flex: 1;
            min-width: 100px;
            padding: 10px 15px;
            background: #f8f9fa;
            color: #333;
            border: 2px solid transparent;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: #e9ecef;
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .formula-category {
            display: none;
        }

        .formula-category.active {
            display: block;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
            user-select: none;
        }

        .alarm-badge {
            background: #e74c3c;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            margin-left: 5px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }

            .tab-btn {
                min-width: 80px;
                padding: 8px 10px;
                font-size: 12px;
            }

            .gpa-number {
                font-size: 36px;
            }

            .timer-display {
                font-size: 36px;
            }

            .stat-number {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Engineering Student Dashboard</h1>
            <p>Your complete academic command center</p>
        </div>

        <div class="grid">
            <!-- GPA Calculator -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üìä</span>
                    <h2 class="card-title">GPA Calculator</h2>
                </div>
                <div class="input-group">
                    <label>Course Name</label>
                    <input type="text" id="courseName" placeholder="e.g., Thermodynamics">
                </div>
                <div class="input-group">
                    <label>Grade</label>
                    <select id="courseGrade">
                        <option value="4.0">A (4.0)</option>
                        <option value="3.7">A- (3.7)</option>
                        <option value="3.3">B+ (3.3)</option>
                        <option value="3.0">B (3.0)</option>
                        <option value="2.7">B- (2.7)</option>
                        <option value="2.3">C+ (2.3)</option>
                        <option value="2.0">C (2.0)</option>
                        <option value="1.7">C- (1.7)</option>
                        <option value="1.3">D+ (1.3)</option>
                        <option value="1.0">D (1.0)</option>
                        <option value="0.0">F (0.0)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Credit Hours</label>
                    <input type="number" id="courseCredits" value="3" min="1" max="6">
                </div>
                <button onclick="addCourse()">Add Course</button>
                <div id="courseList" style="margin-top: 20px;"></div>
                <div class="gpa-display">
                    <div>Current GPA</div>
                    <div class="gpa-number" id="gpaDisplay">0.00</div>
                    <div>Total Credits: <span id="totalCredits">0</span></div>
                </div>
            </div>

            <!-- Assignment Tracker -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üìù</span>
                    <h2 class="card-title">Assignment Tracker</h2>
                </div>
                <div class="input-group">
                    <label>Assignment Name</label>
                    <input type="text" id="assignmentName" placeholder="e.g., Fluid Mechanics Lab Report">
                </div>
                <div class="input-group">
                    <label>Course</label>
                    <input type="text" id="assignmentCourse" placeholder="e.g., ME 301">
                </div>
                <div class="input-group">
                    <label>Due Date</label>
                    <input type="date" id="assignmentDue">
                </div>
                <div class="input-group">
                    <label>Priority</label>
                    <select id="assignmentPriority">
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                    </select>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="assignmentAlarm" checked>
                    <label for="assignmentAlarm">üîî Set reminder notification for this deadline</label>
                </div>
                <button onclick="addAssignment()">Add Assignment</button>
                <div id="assignmentList" style="margin-top: 20px;"></div>
            </div>

            <!-- Study Timer (Pomodoro) -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">‚è±Ô∏è</span>
                    <h2 class="card-title">Study Timer</h2>
                </div>
                <div class="timer-display" id="timerDisplay">25:00</div>
                <div class="timer-controls">
                    <button onclick="startTimer()">Start</button>
                    <button onclick="pauseTimer()">Pause</button>
                    <button onclick="resetTimer()">Reset</button>
                </div>
                <div class="input-group" style="margin-top: 20px;">
                    <label>Session Type</label>
                    <select id="sessionType" onchange="changeSessionType()">
                        <option value="25">Study (25 min)</option>
                        <option value="5">Short Break (5 min)</option>
                        <option value="15">Long Break (15 min)</option>
                    </select>
                </div>
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-number" id="sessionsCompleted">0</div>
                        <div class="stat-label">Sessions Today</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="studyTime">0</div>
                        <div class="stat-label">Hours This Week</div>
                    </div>
                </div>
            </div>

            <!-- Weekly Schedule -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üìÖ</span>
                    <h2 class="card-title">Weekly Schedule</h2>
                </div>
                <div class="input-group">
                    <label>Class/Event</label>
                    <input type="text" id="scheduleName" placeholder="e.g., Calculus III">
                </div>
                <div class="input-group">
                    <label>Day</label>
                    <select id="scheduleDay">
                        <option value="Monday">Saturday</option>
                        <option value="Monday">Sunday</option>
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Time</label>
                    <input type="time" id="scheduleTime">
                </div>
                <div class="input-group">
                    <label>Location</label>
                    <input type="text" id="scheduleLocation" placeholder="e.g., Engineering Hall 301">
                </div>
                <button onclick="addScheduleItem()">Add to Schedule</button>
                <div id="scheduleList" style="margin-top: 20px;"></div>
            </div>

            <!-- Quick Reference Formulas -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üßÆ</span>
                    <h2 class="card-title">Quick Reference</h2>
                </div>
                
                <div class="category-tabs">
                    <button class="tab-btn active" onclick="showCategory('electricity')">‚ö° Electricity</button>
                    <button class="tab-btn" onclick="showCategory('motion')">üöÄ Motion</button>
                    <button class="tab-btn" onclick="showCategory('energy')">üí° Energy</button>
                    <button class="tab-btn" onclick="showCategory('fluids')">üíß Fluids</button>
                    <button class="tab-btn" onclick="showCategory('materials')">üîß Materials</button>
                    <button class="tab-btn" onclick="showCategory('thermo')">üî• Thermo</button>
                </div>

                <div id="electricity" class="formula-category active">
                    <div class="formula-card">
                        <strong>Ohm's Law:</strong> V = IR
                    </div>
                    <div class="formula-card">
                        <strong>Power:</strong> P = IV = V¬≤/R = I¬≤R
                    </div>
                    <div class="formula-card">
                        <strong>Coulomb's Law:</strong> F = k(q‚ÇÅq‚ÇÇ)/r¬≤
                    </div>
                    <div class="formula-card">
                        <strong>Capacitance:</strong> C = Q/V
                    </div>
                    <div class="formula-card">
                        <strong>Resistance (series):</strong> R_total = R‚ÇÅ + R‚ÇÇ + R‚ÇÉ
                    </div>
                    <div class="formula-card">
                        <strong>Resistance (parallel):</strong> 1/R_total = 1/R‚ÇÅ + 1/R‚ÇÇ + 1/R‚ÇÉ
                    </div>
                </div>

                <div id="motion" class="formula-category">
                    <div class="formula-card">
                        <strong>Newton's 2nd Law:</strong> F = ma
                    </div>
                    <div class="formula-card">
                        <strong>Velocity:</strong> v = v‚ÇÄ + at
                    </div>
                    <div class="formula-card">
                        <strong>Position:</strong> x = x‚ÇÄ + v‚ÇÄt + ¬Ωat¬≤
                    </div>
                    <div class="formula-card">
                        <strong>Momentum:</strong> p = mv
                    </div>
                    <div class="formula-card">
                        <strong>Impulse:</strong> J = FŒît = Œîp
                    </div>
                    <div class="formula-card">
                        <strong>Centripetal Force:</strong> F = mv¬≤/r
                    </div>
                    <div class="formula-card">
                        <strong>Angular Velocity:</strong> œâ = Œ∏/t
                    </div>
                </div>

                <div id="energy" class="formula-category">
                    <div class="formula-card">
                        <strong>Kinetic Energy:</strong> KE = ¬Ωmv¬≤
                    </div>
                    <div class="formula-card">
                        <strong>Potential Energy:</strong> PE = mgh
                    </div>
                    <div class="formula-card">
                        <strong>Work:</strong> W = F¬∑d¬∑cos(Œ∏)
                    </div>
                    <div class="formula-card">
                        <strong>Power:</strong> P = W/t = F¬∑v
                    </div>
                    <div class="formula-card">
                        <strong>Elastic Potential:</strong> PE = ¬Ωkx¬≤
                    </div>
                    <div class="formula-card">
                        <strong>Conservation:</strong> KE‚ÇÅ + PE‚ÇÅ = KE‚ÇÇ + PE‚ÇÇ
                    </div>
                </div>

                <div id="fluids" class="formula-category">
                    <div class="formula-card">
                        <strong>Bernoulli's Equation:</strong> P + ¬ΩœÅv¬≤ + œÅgh = constant
                    </div>
                    <div class="formula-card">
                        <strong>Continuity:</strong> A‚ÇÅv‚ÇÅ = A‚ÇÇv‚ÇÇ
                    </div>
                    <div class="formula-card">
                        <strong>Pressure:</strong> P = F/A
                    </div>
                    <div class="formula-card">
                        <strong>Hydrostatic Pressure:</strong> P = œÅgh
                    </div>
                    <div class="formula-card">
                        <strong>Buoyancy:</strong> F_b = œÅ_fluid¬∑V_displaced¬∑g
                    </div>
                    <div class="formula-card">
                        <strong>Flow Rate:</strong> Q = A¬∑v
                    </div>
                </div>

                <div id="materials" class="formula-category">
                    <div class="formula-card">
                        <strong>Stress:</strong> œÉ = F/A
                    </div>
                    <div class="formula-card">
                        <strong>Strain:</strong> Œµ = ŒîL/L‚ÇÄ
                    </div>
                    <div class="formula-card">
                        <strong>Young's Modulus:</strong> E = œÉ/Œµ
                    </div>
                    <div class="formula-card">
                        <strong>Shear Stress:</strong> œÑ = F/A
                    </div>
                    <div class="formula-card">
                        <strong>Hooke's Law:</strong> F = kx
                    </div>
                    <div class="formula-card">
                        <strong>Moment of Inertia:</strong> I = ‚à´r¬≤dA
                    </div>
                </div>

                <div id="thermo" class="formula-category">
                    <div class="formula-card">
                        <strong>Ideal Gas Law:</strong> PV = nRT
                    </div>
                    <div class="formula-card">
                        <strong>1st Law of Thermo:</strong> ŒîU = Q - W
                    </div>
                    <div class="formula-card">
                        <strong>Heat Transfer:</strong> Q = mcŒîT
                    </div>
                    <div class="formula-card">
                        <strong>Thermal Expansion:</strong> ŒîL = Œ±L‚ÇÄŒîT
                    </div>
                    <div class="formula-card">
                        <strong>Efficiency:</strong> Œ∑ = W_out/Q_in
                    </div>
                    <div class="formula-card">
                        <strong>Entropy:</strong> ŒîS = Q/T
                    </div>
                </div>
            </div>

            <!-- Quick Notes -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üìã</span>
                    <h2 class="card-title">Quick Notes</h2>
                </div>
                <textarea class="notes-area" id="quickNotes" placeholder="Jot down quick notes, ideas, or reminders..."></textarea>
                <button onclick="saveNotes()" style="margin-top: 10px;">Save Notes</button>
                <p style="margin-top: 10px; color: #666; font-size: 12px;">Notes are auto-saved locally</p>
            </div>

            <!-- Useful Links -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üîó</span>
                    <h2 class="card-title">Quick Links</h2>
                </div>
                <div class="quick-links">
                    <a href="https://www.wolframalpha.com/" target="_blank" class="quick-link">üßÆ WolframAlpha</a>
                    <a href="https://www.desmos.com/calculator" target="_blank" class="quick-link">üìà Desmos</a>
                    <a href="https://www.mathway.com/" target="_blank" class="quick-link">‚ûó Mathway</a>
                    <a href="https://www.symbolab.com/" target="_blank" class="quick-link">‚à´ Symbolab</a>
                    <a href="https://www.khanacademy.org/" target="_blank" class="quick-link">üéì Khan Academy</a>
                    <a href="https://www.coursera.org/" target="_blank" class="quick-link">üìö Coursera</a>
                    <a href="https://github.com/" target="_blank" class="quick-link">üíª GitHub</a>
                    <a href="https://stackoverflow.com/" target="_blank" class="quick-link">‚ùì Stack Overflow</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test localStorage availability
        function testLocalStorage() {
            try {
                const test = 'test';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                console.log('‚úÖ localStorage is available');
                return true;
            } catch(e) {
                console.error('‚ùå localStorage is NOT available:', e);
                alert('Warning: Local storage is not available. Your data will not be saved between sessions. This may be due to browser privacy settings or incognito mode.');
                return false;
            }
        }

        // GPA Calculator
        let courses = [];

        function loadCourses() {
            const saved = localStorage.getItem('courses');
            if (saved) {
                try {
                    courses = JSON.parse(saved);
                    console.log('‚úÖ Loaded courses:', courses.length);
                    updateCourseList();
                    calculateGPA();
                } catch (e) {
                    console.error('Error loading courses:', e);
                    courses = [];
                }
            }
        }

        function addCourse() {
            const name = document.getElementById('courseName').value;
            const grade = parseFloat(document.getElementById('courseGrade').value);
            const credits = parseInt(document.getElementById('courseCredits').value);

            if (name && credits) {
                courses.push({ 
                    name, 
                    grade, 
                    credits,
                    id: Date.now()
                });
                saveCourses();
                updateCourseList();
                calculateGPA();
                document.getElementById('courseName').value = '';
                console.log('‚úÖ Course added:', name);
            }
        }

        function deleteCourse(index) {
            const courseName = courses[index].name;
            courses.splice(index, 1);
            saveCourses();
            updateCourseList();
            calculateGPA();
            console.log('‚úÖ Course deleted:', courseName);
        }

        function saveCourses() {
            try {
                localStorage.setItem('courses', JSON.stringify(courses));
                console.log('‚úÖ Courses saved to localStorage');
            } catch (e) {
                console.error('Error saving courses:', e);
                alert('Failed to save courses. Storage may be full.');
            }
        }

        function updateCourseList() {
            const list = document.getElementById('courseList');
            list.innerHTML = courses.map((course, index) => `
                <div class="course-item">
                    <div>
                        <strong>${course.name}</strong><br>
                        <small>Grade: ${course.grade.toFixed(1)} | Credits: ${course.credits}</small>
                    </div>
                    <button class="delete-btn" onclick="deleteCourse(${index})">Delete</button>
                </div>
            `).join('');
        }

        function calculateGPA() {
            let totalPoints = 0;
            let totalCredits = 0;

            courses.forEach(course => {
                totalPoints += course.grade * course.credits;
                totalCredits += course.credits;
            });

            const gpa = totalCredits > 0 ? (totalPoints / totalCredits).toFixed(2) : '0.00';
            document.getElementById('gpaDisplay').textContent = gpa;
            document.getElementById('totalCredits').textContent = totalCredits;
        }

        // Assignment Tracker
        let assignments = [];

        function loadAssignments() {
            const saved = localStorage.getItem('assignments');
            if (saved) {
                try {
                    assignments = JSON.parse(saved);
                    console.log('‚úÖ Loaded assignments:', assignments.length);
                    updateAssignmentList();
                } catch (e) {
                    console.error('Error loading assignments:', e);
                    assignments = [];
                }
            }
        }

        function addAssignment() {
            const name = document.getElementById('assignmentName').value;
            const course = document.getElementById('assignmentCourse').value;
            const due = document.getElementById('assignmentDue').value;
            const priority = document.getElementById('assignmentPriority').value;
            const alarm = document.getElementById('assignmentAlarm').checked;

            if (name && course && due) {
                assignments.push({ 
                    name, 
                    course, 
                    due, 
                    priority, 
                    alarm,
                    completed: false,
                    id: Date.now()
                });
                assignments.sort((a, b) => new Date(a.due) - new Date(b.due));
                saveAssignments();
                updateAssignmentList();
                
                // Clear form
                document.getElementById('assignmentName').value = '';
                document.getElementById('assignmentCourse').value = '';
                document.getElementById('assignmentDue').value = '';
                document.getElementById('assignmentAlarm').checked = true;
                console.log('‚úÖ Assignment added:', name);
            }
        }

        function toggleAssignment(index) {
            assignments[index].completed = !assignments[index].completed;
            saveAssignments();
            updateAssignmentList();
            console.log('‚úÖ Assignment toggled:', assignments[index].name);
        }

        function deleteAssignment(index) {
            const assignmentName = assignments[index].name;
            assignments.splice(index, 1);
            saveAssignments();
            updateAssignmentList();
            console.log('‚úÖ Assignment deleted:', assignmentName);
        }

        function saveAssignments() {
            try {
                localStorage.setItem('assignments', JSON.stringify(assignments));
                console.log('‚úÖ Assignments saved to localStorage');
            } catch (e) {
                console.error('Error saving assignments:', e);
                alert('Failed to save assignments. Storage may be full.');
            }
        }

        function updateAssignmentList() {
            const list = document.getElementById('assignmentList');
            list.innerHTML = assignments.map((assignment, index) => {
                const dueDate = new Date(assignment.due);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const dueDateOnly = new Date(dueDate);
                dueDateOnly.setHours(0, 0, 0, 0);
                const daysUntil = Math.ceil((dueDateOnly - today) / (1000 * 60 * 60 * 24));
                
                let dueText;
                if (daysUntil < 0) {
                    dueText = `<span style="color: #e74c3c;">Overdue by ${Math.abs(daysUntil)} days</span>`;
                } else if (daysUntil === 0) {
                    dueText = '<span style="color: #e74c3c; font-weight: bold;">Due Today!</span>';
                } else if (daysUntil === 1) {
                    dueText = '<span style="color: #f39c12;">Due Tomorrow</span>';
                } else {
                    dueText = `Due in ${daysUntil} days`;
                }

                const alarmBadge = assignment.alarm ? '<span class="alarm-badge">üîî Alarm</span>' : '';
                
                return `
                <div class="assignment-item priority-${assignment.priority} ${assignment.completed ? 'completed' : ''}">
                    <div>
                        <strong>${assignment.name}</strong>${alarmBadge}<br>
                        <small>${assignment.course} | ${dueText}</small>
                    </div>
                    <div>
                        <button onclick="toggleAssignment(${index})" style="margin-right: 5px; padding: 5px 10px; font-size: 12px;">
                            ${assignment.completed ? '‚Ü©Ô∏è' : '‚úì'}
                        </button>
                        <button class="delete-btn" onclick="deleteAssignment(${index})">Delete</button>
                    </div>
                </div>
            `}).join('');
        }

        // Study Timer
        let timerInterval;
        let timeLeft = 25 * 60;
        let isRunning = false;
        let sessionsCompleted = 0;
        let studyTime = 0;

        function loadTimerStats() {
            const savedSessions = localStorage.getItem('sessionsCompleted');
            const savedStudyTime = localStorage.getItem('studyTime');
            
            if (savedSessions !== null) {
                sessionsCompleted = parseInt(savedSessions);
                console.log('‚úÖ Loaded sessions:', sessionsCompleted);
            }
            if (savedStudyTime !== null) {
                studyTime = parseInt(savedStudyTime);
                console.log('‚úÖ Loaded study time:', studyTime);
            }
            
            document.getElementById('sessionsCompleted').textContent = sessionsCompleted;
            document.getElementById('studyTime').textContent = studyTime;
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timerDisplay').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function startTimer() {
            if (!isRunning) {
                isRunning = true;
                timerInterval = setInterval(() => {
                    if (timeLeft > 0) {
                        timeLeft--;
                        updateTimerDisplay();
                    } else {
                        pauseTimer();
                        
                        // Vibrate if supported (for mobile)
                        if (navigator.vibrate) {
                            navigator.vibrate([200, 100, 200, 100, 200]);
                        }
                        
                        alert('Session completed! Take a break.');
                        sessionsCompleted++;
                        studyTime++;
                        
                        // Save to localStorage
                        localStorage.setItem('sessionsCompleted', sessionsCompleted.toString());
                        localStorage.setItem('studyTime', studyTime.toString());
                        console.log('‚úÖ Timer stats saved');
                        
                        document.getElementById('sessionsCompleted').textContent = sessionsCompleted;
                        document.getElementById('studyTime').textContent = studyTime;
                        resetTimer();
                    }
                }, 1000);
            }
        }

        function pauseTimer() {
            isRunning = false;
            clearInterval(timerInterval);
        }

        function resetTimer() {
            pauseTimer();
            const sessionType = parseInt(document.getElementById('sessionType').value);
            timeLeft = sessionType * 60;
            updateTimerDisplay();
        }

        function changeSessionType() {
            resetTimer();
        }

        // Schedule
        let scheduleItems = [];

        function loadSchedule() {
            const saved = localStorage.getItem('schedule');
            if (saved) {
                try {
                    scheduleItems = JSON.parse(saved);
                    console.log('‚úÖ Loaded schedule items:', scheduleItems.length);
                    updateScheduleList();
                } catch (e) {
                    console.error('Error loading schedule:', e);
                    scheduleItems = [];
                }
            }
        }

        function addScheduleItem() {
            const name = document.getElementById('scheduleName').value;
            const day = document.getElementById('scheduleDay').value;
            const time = document.getElementById('scheduleTime').value;
            const location = document.getElementById('scheduleLocation').value;

            if (name && day && time) {
                scheduleItems.push({ 
                    name, 
                    day, 
                    time, 
                    location,
                    id: Date.now()
                });
                scheduleItems.sort((a, b) => {
                    const dayOrder = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
                    const dayDiff = dayOrder.indexOf(a.day) - dayOrder.indexOf(b.day);
                    if (dayDiff !== 0) return dayDiff;
                    return a.time.localeCompare(b.time);
                });
                saveSchedule();
                updateScheduleList();
                
                // Clear form
                document.getElementById('scheduleName').value = '';
                document.getElementById('scheduleTime').value = '';
                document.getElementById('scheduleLocation').value = '';
                console.log('‚úÖ Schedule item added:', name);
            }
        }

        function deleteScheduleItem(index) {
            const itemName = scheduleItems[index].name;
            scheduleItems.splice(index, 1);
            saveSchedule();
            updateScheduleList();
            console.log('‚úÖ Schedule item deleted:', itemName);
        }

        function saveSchedule() {
            try {
                localStorage.setItem('schedule', JSON.stringify(scheduleItems));
                console.log('‚úÖ Schedule saved to localStorage');
            } catch (e) {
                console.error('Error saving schedule:', e);
                alert('Failed to save schedule. Storage may be full.');
            }
        }

        function updateScheduleList() {
            const list = document.getElementById('scheduleList');
            list.innerHTML = scheduleItems.map((item, index) => `
                <div class="schedule-item">
                    <div>
                        <strong>${item.name}</strong><br>
                        <small>${item.day}, ${item.time} | ${item.location || 'No location'}</small>
                    </div>
                    <button class="delete-btn" onclick="deleteScheduleItem(${index})">Delete</button>
                </div>
            `).join('');
        }

        // Quick Notes
        const notesTextarea = document.getElementById('quickNotes');
        
        function loadNotes() {
            const saved = localStorage.getItem('quickNotes');
            if (saved !== null) {
                notesTextarea.value = saved;
                console.log('‚úÖ Loaded notes');
            }
        }

        // Auto-save notes as user types
        notesTextarea.addEventListener('input', () => {
            try {
                localStorage.setItem('quickNotes', notesTextarea.value);
            } catch (e) {
                console.error('Error saving notes:', e);
            }
        });

        function saveNotes() {
            try {
                localStorage.setItem('quickNotes', notesTextarea.value);
                console.log('‚úÖ Notes saved');
                alert('Notes saved!');
            } catch (e) {
                console.error('Error saving notes:', e);
                alert('Failed to save notes. Storage may be full.');
            }
        }

        // Category tabs for Quick Reference
        function showCategory(category) {
            // Hide all categories
            document.querySelectorAll('.formula-category').forEach(cat => {
                cat.classList.remove('active');
            });
            
            // Remove active from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected category
            document.getElementById(category).classList.add('active');
            
            // Highlight active tab
            event.target.classList.add('active');
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Dashboard initializing...');
            
            // Test localStorage first
            if (!testLocalStorage()) {
                return;
            }
            
            // Load all data
            loadCourses();
            loadAssignments();
            loadSchedule();
            loadNotes();
            loadTimerStats();
            updateTimerDisplay();
            
            console.log('‚úÖ Dashboard fully loaded!');
            console.log('üìä Courses:', courses.length);
            console.log('üìù Assignments:', assignments.length);
            console.log('üìÖ Schedule items:', scheduleItems.length);
        });
    </script>
</body>
</html>